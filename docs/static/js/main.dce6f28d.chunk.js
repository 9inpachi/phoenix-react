/*! For license information please see main.dce6f28d.chunk.js.LICENSE.txt */
(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{20:function(e,t,n){e.exports=n(33)},25:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r=n(3),o=n.n(r),i=n(10),a=n.n(i),s=(n(25),n(1)),c=n(0),l=n(11),h=function(){function e(e){var t=this;this.controls=[],this.mainControls=null,this.overlayControls=null;var n=new c.lb(75,window.innerWidth/window.innerHeight,10,1e5),r=new c.kb(-window.innerWidth/2,window.innerWidth/2,window.innerHeight/2,-window.innerHeight/2,10,1e5);this.perspectiveControls=this.setOrbitControls(n,e.getMainRenderer().domElement),this.orthographicControls=this.setOrbitControls(r,e.getMainRenderer().domElement),n.position.z=r.position.z=200,this.addControls(this.perspectiveControls),this.addControls(this.orthographicControls),this.setActiveControls(this.perspectiveControls),this.setMainControls(this.perspectiveControls),this.setOverlayControls(this.orthographicControls),this.getActiveControls().addEventListener("change",(function(){t.transformSync(),t.updateSync()})),this.initializeZoomControls()}return e.prototype.setOrbitControls=function(e,t){var n=new l.a(e,t);return n.enableDamping=!0,n.dampingFactor=.25,n.enableZoom=!0,n.autoRotate=!1,n},e.prototype.setActiveControls=function(e){this.activeControls=e},e.prototype.setMainControls=function(e){this.mainControls=e},e.prototype.setOverlayControls=function(e){this.overlayControls=e},e.prototype.getActiveControls=function(){return this.activeControls},e.prototype.getMainControls=function(){return this.mainControls},e.prototype.getOverlayControls=function(){return this.overlayControls},e.prototype.getActiveCamera=function(){return this.activeControls.object},e.prototype.getMainCamera=function(){return this.mainControls.object},e.prototype.getOverlayCamera=function(){return this.overlayControls.object},e.prototype.getAllCameras=function(){return[this.getMainCamera(),this.getOverlayCamera()]},e.prototype.addControls=function(e){this.containsObject(e,this.controls)||this.controls.push(e)},e.prototype.removeControls=function(e){var t=this.controls.indexOf(e);t>-1&&this.controls.splice(t,1)},e.prototype.swapControls=function(){var e=this.mainControls;this.mainControls=this.overlayControls,this.overlayControls=e},e.prototype.updateSync=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n!==this.activeControls&&this.update(n)}},e.prototype.update=function(e){e.update()},e.prototype.transformSync=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n!==this.activeControls&&(this.positionSync(n),this.rotationSync(n))}},e.prototype.zoomTo=function(e,t){for(var n=0,r=this.zoomCameraAnimPairs;n<r.length;n++){var o=r[n],i=o.camera,a=o.anim;if(i.isOrthographicCamera)a.to({zoom:i.zoom*(1/e)},t),i.updateProjectionMatrix();else{var s=i.position;a.to({x:s.x*e,y:s.y*e,z:s.z*e},t)}a.start()}},e.prototype.lookAtObject=function(e,t){var n=this,r=new c.Rb(0,0,0);t.traverse((function(t){if(t.uuid===e){var o=new c.Rb;if(t instanceof c.z?t.traverse((function(e){0===e.children.length&&(e.position.equals(r)?o.add(e.geometry.boundingSphere.getBoundingBox().max):o.add(e.position))})):o=t.position.equals(r)?t.geometry.boundingSphere.center:t.position,o.distanceTo(r)>1)for(var i=0,a=n.getAllCameras();i<a.length;i++){var l=a[i];new s.Tween(l.position).to({x:1.1*o.x,y:1.1*o.y,z:1.1*o.z},200).start()}}}))},e.prototype.initializeZoomControls=function(){var e=this.getAllCameras();this.zoomCameraAnimPairs=[];for(var t=0,n=e;t<n.length;t++){var r=n[t],o=r.isOrthographicCamera?new s.Tween(r):new s.Tween(r.position);this.zoomCameraAnimPairs.push({camera:r,anim:o})}},e.prototype.positionSync=function(e){e.object.position.set(this.activeControls.object.position.x,this.activeControls.object.position.y,this.activeControls.object.position.z)},e.prototype.rotationSync=function(e){e.target=this.activeControls.target},e.prototype.containsObject=function(e,t){for(var n=0,r=t;n<r.length;n++){if(r[n]===e)return!0}return!1},e.prototype.objectIndex=function(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},e}(),u=function(){function e(e){this.mainRenderer=null,this.overlayRenderer=null,this.renderers=[],this.setRenderer(e)}return e.prototype.render=function(e,t){if(this.getOverlayRenderer()&&!this.getOverlayRenderer().domElement.hidden){var n=e.background;e.background=null,this.isFixedOverlay()||this.getOverlayRenderer().render(e,t.getOverlayCamera()),e.background=n}},e.prototype.setRenderer=function(e){var t=new c.Ub;this.addRenderer(t),this.setMainRenderer(t),this.getMainRenderer().setSize(window.innerWidth,window.innerHeight,!1),this.getMainRenderer().setPixelRatio(window.devicePixelRatio),this.getMainRenderer().domElement.className="ui-element",this.getMainRenderer().domElement.id="three-canvas";var n=document.getElementById(e);null==n&&(n=document.body),n.appendChild(this.getMainRenderer().domElement)},e.prototype.setMainRenderer=function(e){this.mainRenderer=e},e.prototype.setOverlayRenderer=function(e){var t={canvas:e,antialias:!1,alpha:!0},n=new c.Ub(t);this.addRenderer(n),this.overlayRenderer=n},e.prototype.setRenderers=function(e){this.renderers=e},e.prototype.getMainRenderer=function(){return this.mainRenderer},e.prototype.getOverlayRenderer=function(){return this.overlayRenderer},e.prototype.getRenderers=function(){return this.renderers},e.prototype.addRenderer=function(e){this.containsObject(e,this.renderers)||this.renderers.push(e)},e.prototype.removeControls=function(e){var t=this.renderers.indexOf(e);t>-1&&this.renderers.splice(t,1)},e.prototype.swapRenderers=function(e,t){var n=e;e=t,t=n},e.prototype.containsObject=function(e,t){for(var n=0,r=t;n<r.length;n++){if(r[n]===e)return!0}return!1},e.prototype.setLocalClippingEnabled=function(e){for(var t=0,n=this.renderers;t<n.length;t++){n[t].localClippingEnabled=e}},e.prototype.getLocalClipping=function(){if(this.renderers.length>0)return this.renderers[0].localClippingEnabled},e.prototype.isFixedOverlay=function(){return this.fixedOverlay},e.prototype.setFixOverlay=function(e){this.fixedOverlay=e},e}(),p=n(12),g=n(13),d=function(){function e(){}return e.prototype.exportSceneToOBJ=function(e){var t=(new p.a).parse(e);this.saveString(t,"phoenix-obj.obj")},e.prototype.exportPhoenixScene=function(e,t,n){var r=this,o=new g.a,i=this.saveSceneConfig(t,n);o.parse(e,(function(e){var t={sceneConfiguration:i,scene:e},n=JSON.stringify(t,null,2);r.saveString(n,"phoenix-scene.phnx")}),null)},e.prototype.saveSceneConfig=function(e,t){return{eventData:this.saveEventDataConfiguration(e),geometries:this.saveGeometriesConfiguration(t)}},e.prototype.saveEventDataConfiguration=function(e){for(var t={},n=0,r=e.children;n<r.length;n++){var o=r[n];if(o.name){t[o.name]=[];for(var i=0,a=o.children;i<a.length;i++){var s=a[i];s.name&&t[o.name].push(s.name)}}}return t},e.prototype.saveGeometriesConfiguration=function(e){var t=[];return e.children.forEach((function(e){"EventData"!==e.name&&t.push(e.name)})),t},e.prototype.saveString=function(e,t){this.save(new Blob([e],{type:"text/plain"}),t)},e.prototype.save=function(e,t){var n=document.createElement("a");n.style.display="none",document.body.appendChild(n),n.href=URL.createObjectURL(e),n.download=t,n.click()},e}(),m=n(6),f=n(7),v=function(){function e(e,t,n){this.clipPlanes=e,this.EVENT_DATA_ID=t,this.GEOMETRIES_ID=n}return e.prototype.loadOBJGeometry=function(e,t,n,r,o){var i=this;null==r&&(r=4302580),(new m.a).load(t,(function(t){var a=i.processOBJ(t,n,r,o,"OBJ file");e(a)}))},e.prototype.parseOBJGeometry=function(e,t){var n=(new m.a).parse(e);return this.processOBJ(n,t,4302580,!1,"OBJ file loaded from the client.")},e.prototype.processOBJ=function(e,t,n,r,o){return e.name=t,e.userData={info:o},this.setObjFlat(e,n,r)},e.prototype.setObjFlat=function(e,t,n){var r=new c.X({color:t,shininess:0,wireframe:!1,clippingPlanes:this.clipPlanes,clipIntersection:!0,clipShadows:!1,side:n?c.r:c.x});return e.traverse((function(n){n instanceof c.U?(n.name=e.name,n.userData=e.userData,n.material instanceof c.Q&&(n.material.dispose(),n.material=r),n.castShadow=!1,n.receiveShadow=!1):n instanceof c.J&&n.material instanceof c.H&&n.material.color.set(t)})),e},e.prototype.parseGLTFGeometry=function(e,t){var n=this,r=new f.a,o=JSON.stringify(e,null,2);r.parse(o,"",(function(e){var r=e.scene.getObjectByName(n.EVENT_DATA_ID),o=e.scene.getObjectByName(n.GEOMETRIES_ID);t(r,o)}))},e.prototype.loadGLTFGeometry=function(e,t,n,r){var o=this;(new f.a).load(e,(function(e){var i=e.scene;o.processGeometry(i,t,r),n(i)}))},e.prototype.loadJSONGeometry=function(e,t,n,r,o){var i=this,a=new c.jb;if("string"===typeof e)a.load(e,(function(e){i.processGeometry(e,t,r,o),n(e)}));else if("object"===typeof e){var s=a.parse(e);this.processGeometry(s,t,r,o),n(s)}},e.prototype.processGeometry=function(e,t,n,r){var o=this;e.name=t,n&&e.scale.set(n,n,n),e.traverse((function(e){if(e instanceof c.U&&(e.name?e.userData.name=e.name:e.name=e.userData.name=t,e.material instanceof c.Q)){var n=e.material.color?e.material.color:3135121,i=r?c.r:e.material.side;e.material.dispose(),e.material=new c.X({color:n,shininess:0,side:i}),e.material.clippingPlanes=o.clipPlanes,e.material.clipIntersection=!0,e.material.clipShadows=!1}}))},e}(),y=n(35),b=function(){function e(){var e=this;this.activeObject=new y.a(""),this.onTouchMove=function(t){var n=e.intersectObject(t);if(n){if(e.ignoreList.includes(n.type))return;e.outlinePass.selectedObjects=[n]}},this.onDocumentMouseDown=function(){var t=e.outlinePass.selectedObjects[0];if(t){e.selectedObject.name=t.name,e.selectedObject.attributes.splice(0,e.selectedObject.attributes.length),e.activeObject.next(t.uuid);for(var n=0,r=Object.keys(t.userData);n<r.length;n++){var o=r[n];e.selectedObject.attributes.push({attributeName:o,attributeValue:t.userData[o]})}var i=Object.keys(t.userData).map((function(e){if(["string","number"].includes(typeof t.userData[e]))return e+"="+t.userData[e]})).filter((function(e){return e})),a=t.name+(i.length>0?" with "+i.join(", "):"");a&&e.infoLogger.add(a,"Clicked")}},this.onTouchDown=function(t){t.preventDefault(),e.onTouchMove(t.targetTouches[0]),e.onDocumentMouseDown()},this.isInit=!1,this.ignoreList=[(new c.b).type,(new c.q).type,(new c.d).type]}return e.prototype.init=function(e,t,n,r){this.camera=e,this.scene=t,this.isInit=!0,this.infoLogger=r,this.effectsManager=n,this.outlinePass=this.effectsManager.addOutlinePassForSelection()},e.prototype.setSelectedObject=function(e){this.selectedObject=e},e.prototype.getActiveObjectId=function(){return this.activeObject},e.prototype.setSelecting=function(e){this.isInit&&(e?this.enableSelecting():this.disableSelecting())},e.prototype.enableSelecting=function(){document.getElementById("three-canvas").addEventListener("mousemove",this.onTouchMove,!0),document.getElementById("three-canvas").addEventListener("click",this.onDocumentMouseDown,!0),document.getElementById("three-canvas").addEventListener("touchstart",this.onTouchDown)},e.prototype.disableSelecting=function(){document.getElementById("three-canvas").removeEventListener("mousemove",this.onTouchMove,!0),document.getElementById("three-canvas").removeEventListener("click",this.onDocumentMouseDown,!0),document.getElementById("three-canvas").removeEventListener("touchstart",this.onTouchDown),this.outlinePass.selectedObjects=[]},e.prototype.intersectObject=function(e){var t;null===(t=e.preventDefault)||void 0===t||t.call(e);var n=new c.Qb,r=this.effectsManager.composer.renderer.domElement;n.x=e.clientX/r.clientWidth*2-1,n.y=-e.clientY/r.clientHeight*2+1;var o=new c.yb;o.setFromCamera(n,this.camera),o.params.Line.threshold=3;var i=o.intersectObjects(this.scene.children,!0);if(i.length>0)return i[0].object},e.prototype.highlightObject=function(e,t){var n=this;t.traverse((function(t){t.uuid===e&&(n.outlinePass.selectedObjects=[t])}))},e}(),C=function(){function e(e,t){void 0===t&&(t=!0),this.useCameraLight=!0,this.getScene(),this.ignoreList=e,this.scene.background=new c.o("hsl(0, 0%, 100%)"),this.axis=null,this.setLights(t)}return e.prototype.setLights=function(e){var t=this;void 0===e&&(e=!0),this.useCameraLight=e;var n=new c.b(16777215,.6);this.scene.add(n),this.useCameraLight?(this.cameraLight=new c.q(16777215,.45),this.cameraLight.position.set(0,0,10),this.scene.add(this.cameraLight)):[[-100,-50,100],[100,50,-100],[-100,50,-100],[100,-50,100]].forEach((function(e){var n=new c.q(16777215,.2);n.position.set(e[0],e[1],e[2]),t.scene.add(n)}))},e.prototype.updateLights=function(e){this.useCameraLight&&this.cameraLight.position.copy(e.position)},e.prototype.getScene=function(){return this.scene||(this.scene=new c.Ab),this.scene},e.prototype.getCleanScene=function(){var e=this,t=this.scene.clone(),n=[];return t.traverse((function(t){e.ignoreList.includes(t.type)&&n.push(t)})),t.remove.apply(t,n),t},e.prototype.darkBackground=function(e){var t=16777215;e&&(t=0),this.scene&&(this.scene.background=new c.o(t))},e.prototype.setGeometryOpacity=function(e,t){var n=this.scene.getObjectByName(e);t&&n.traverse((function(e){e instanceof c.U&&e.material instanceof c.Q&&(e.material.transparent=!0,e.material.opacity=t)}))},e.prototype.OBJGeometryColor=function(e,t){var n=this.scene.getObjectByName(e);n&&n.traverse((function(e){(e instanceof c.U||e instanceof c.J)&&(e.material instanceof c.X||e.material instanceof c.V||e.material instanceof c.H)&&e.material.color.set(t)}))},e.prototype.objectVisibility=function(e,t,n){var r=(n?this.scene.getObjectByName(n):this.scene).getObjectByName(e);r&&r.traverse((function(e){e.visible=t,t?(e.layers.enable(0),e.layers.disable(1)):(e.layers.disable(0),e.layers.enable(1))}))},e.prototype.getObjectPosition=function(e){var t=this.scene.getObjectByName(e);if(t)return t.position},e.prototype.removeGeometry=function(e){var t=this.scene.getObjectByName(e);this.getGeometries().remove(t)},e.prototype.scaleObject=function(e,t){this.scene.getObjectByName(e).scale.set(t,t,t)},e.prototype.addEventDataTypeGroup=function(e){var t=this.getEventData(),n=this.scene.getObjectByName(e);return n||(n=new c.z),n.name=e,t.add(n),n},e.prototype.collectionColor=function(t,n){for(var r=this.getScene().getObjectByName(e.EVENT_DATA_ID).getObjectByName(t),o=0,i=Object.values(r.children);o<i.length;o++){i[o].traverse((function(e){(e instanceof c.G||e instanceof c.U||e instanceof c.pb)&&(e.material instanceof c.H||e.material instanceof c.V||e.material instanceof c.V||e.material instanceof c.qb||e.material instanceof c.X||e.material instanceof c.ab)&&e.material.color.set(n)}))}},e.prototype.collectionFilter=function(t,n){for(var r=this.getScene().getObjectByName(e.EVENT_DATA_ID).getObjectByName(t),o=0,i=Object.values(r.children);o<i.length;o++){var a=i[o];if(a.userData){var s=a.userData[n.field];s&&(s<=n.maxValue&&s>=n.minValue?a.visible=!0:a.visible=!1)}}},e.prototype.groupVisibility=function(e,t,n){for(var r=(n?this.scene.getObjectByName(n):this.scene).getObjectByName(e),o=0,i=Object.values(r.children);o<i.length;o++){i[o].visible=t}},e.prototype.getObjectsGroup=function(e){var t=this.scene.getObjectByName(e);return null==t&&((t=new c.z).name=e,this.scene.add(t)),t},e.prototype.getEventData=function(){return this.getObjectsGroup(e.EVENT_DATA_ID)},e.prototype.getGeometries=function(){return this.getObjectsGroup(e.GEOMETRIES_ID)},e.prototype.clearEventData=function(){var e=this.getEventData();null!=e&&this.scene.remove(e),this.getEventData()},e.prototype.setAxis=function(e){null==this.axis&&(this.axis=new c.d(2e3),this.scene.add(this.axis)),this.axis.visible=e},e.prototype.eventDataDepthTest=function(e){var t=this.getEventData();null!==t&&t.traverse((function(t){t.material&&(t.renderOrder=e?0:999,t.material.depthTest=e)}))},e.prototype.wireframeGeometries=function(e){this.getGeometries().traverse((function(t){t.material&&(t.material.wireframe=e,e?(t.material.transparent=!0,t.material.opacity=.1):(t.material.transparent=!1,t.material.opacity=1))}))},e.prototype.scaleJets=function(e){var t=this.scene.getObjectByName("Jets");e/=100,t.traverse((function(t){if("Jet"===t.name){var n=t.scale.x;t.scale.setScalar(e),t.position.divideScalar(n).multiplyScalar(e)}}))},e.EVENT_DATA_ID="EventData",e.GEOMETRIES_ID="Geometries",e}(),M=function(){function e(e,t,n){this.scene=e,this.activeCamera=t,this.rendererManager=n,this.animateEvent=this.animateEvent.bind(this),this.animateEventWithClipping=this.animateEventWithClipping.bind(this)}return e.prototype.getCameraTween=function(e,t,n){void 0===t&&(t=1e3);var r=new s.Tween(this.activeCamera.position).to({x:e[0],y:e[1],z:e[2]},t);return n&&r.easing(n),r},e.prototype.animateThroughEvent=function(e,t,n){for(var r=this.getCameraTween(e,1e3,s.Easing.Cubic.Out),o=[0,0,e[2]],i=this.getCameraTween(o,t),a=3*Math.PI/24,c=[],l=1;l<=24;l++)c.push([500*Math.sin(a*l),0,500*Math.cos(a*l)]);for(var h=this.getCameraTween([0,0,500],t,s.Easing.Cubic.Out),u=h,p=4*t/24,g=0,d=c;g<d.length;g++){var m=d[g],f=this.getCameraTween(m,p);u.chain(f),u=f}var v=[0,0,-e[2]],y=this.getCameraTween(v,t,s.Easing.Cubic.In),b=this.getCameraTween(e,t,s.Easing.Cubic.Out);b.onComplete((function(){return null===n||void 0===n?void 0:n()})),b.delay(500),r.chain(i),i.chain(h),u.chain(y),y.chain(b),r.start()},e.prototype.animateEvent=function(e,t,n){var r=this,o=.25*e;e*=.75;var i=this.scene.getObjectByName(C.EVENT_DATA_ID),a=new c.Eb(new c.Rb,0),l=[],h=[];i.traverse((function(t){var n,r,o;if(t.geometry)if("Track"===t.name){var i=null===(o=null===(r=null===(n=t.geometry)||void 0===n?void 0:n.attributes)||void 0===r?void 0:r.position)||void 0===o?void 0:o.count;if(i&&(t.geometry instanceof c.Ob&&(i*=6),t.geometry instanceof c.i)){var a=t.geometry.drawRange.count;t.geometry.setDrawRange(0,0);var u=new s.Tween(t.geometry.drawRange).to({count:i},e);u.onComplete((function(){t.geometry.drawRange.count=a})),h.push(u)}}else if("Jet"===t.name){var p=new s.Tween({x:.01,y:.01,z:.01}).to({x:t.scale.x,y:t.scale.y,z:t.scale.z},e);p.onUpdate((function(e){var n=t.scale.x;t.scale.setScalar(e.x),t.position.divideScalar(n).multiplyScalar(e.x)})),h.push(p)}else{var g=!t.position.equals(new c.Rb(0,0,0))?t.position:t.geometry.boundingSphere.center;"Hit"===t.name?(g=Array.from(t.geometry.attributes.position.array),t.geometry.deleteAttribute("position"),t.geometry.computeBoundingSphere()):t.visible=!1,l.push({eventObject:t,position:g})}}));var u=new s.Tween(a).to({radius:3e3},e),p=function(e){l.forEach((function(t){if("Hit"===t.eventObject.name){var n=t.eventObject.geometry,o=r.getHitsPositions(t.position).filter((function(t){return e.containsPoint((new c.Rb).fromArray(t))}));o.length>0&&(n.setAttribute("position",new c.h(new Float32Array([].concat.apply([],o)),3)),n.computeBoundingSphere())}else e.containsPoint(t.position)&&(t.eventObject.visible=!0)}))};u.onUpdate(p);var g=new s.Tween(a).to({radius:1e4},o);g.onUpdate(p),u.chain(g),h.push(u),h[0].onStart((function(){return null===n||void 0===n?void 0:n()}));for(var d=0,m=h;d<m.length;d++){m[d].easing(s.Easing.Quartic.Out).start()}g.onComplete((function(){p(new c.Eb(new c.Rb,1/0)),null===t||void 0===t||t()}))},e.prototype.animateEventWithClipping=function(e,t,n,r){var o=this;void 0===r&&(r=11e3);for(var i=this.scene.getObjectByName(C.EVENT_DATA_ID),a=new c.Gb(1,8,8),l=[],h=0,u=a.vertices;h<u.length;h++){var p=u[h];l.push(new c.mb(p,0))}var g=this.rendererManager.getMainRenderer().localClippingEnabled;g||this.rendererManager.setLocalClippingEnabled(!0),i.traverse((function(e){e.geometry&&e.material&&(e.material.clippingPlanes=l)}));for(var d=[],m=0,f=l;m<f.length;m++){var v=f[m];v.constant=0;var y=new s.Tween(v).to({constant:r},e);d.push(y)}d[0].onStart((function(){return null===n||void 0===n?void 0:n()}));for(var b=0,M=d;b<M.length;b++){(y=M[b]).start()}d[d.length-1].onComplete((function(){g||(o.rendererManager.getMainRenderer().localClippingEnabled=g),i.traverse((function(e){e.geometry&&e.material&&(e.material.clippingPlanes=null)})),null===t||void 0===t||t()}))},e.prototype.collideParticles=function(e,t,n,r,o){var i,a=this;void 0===t&&(t=10),void 0===n&&(n=5e3),void 0===r&&(r=new c.o(16777215));var l=new c.Fb(t,32,32),h=new c.V({color:r,transparent:!0,opacity:0}),u=new c.U(l,h),p=u.clone();u.position.setZ(n),p.position.setZ(-n);var g=[u,p];(i=this.scene).add.apply(i,g);for(var d=[],m=0,f=g;m<f.length;m++){var v=f[m];new s.Tween(v.material).to({opacity:1},300).start();var y=new s.Tween(v.position).to({z:0},e).start();d.push(y)}d[0].onComplete((function(){var e;(e=a.scene).remove.apply(e,g),null===o||void 0===o||o()}))},e.prototype.animateWithCollision=function(e,t,n){var r,o,i,a,s=this.scene.getObjectByName(C.EVENT_DATA_ID),l=s.getObjectByName("Track");a=l instanceof c.z?null===(o=null===(r=l.children[0])||void 0===r?void 0:r.material)||void 0===o?void 0:o.color:null===(i=l)||void 0===i?void 0:i.material.color,s&&(s.visible=!1),this.collideParticles(1500,30,5e3,a,(function(){e(t,n,(function(){s&&(s.visible=!0)}))}))},e.prototype.animateEventWithCollision=function(e,t){this.animateWithCollision(this.animateEvent,e,t)},e.prototype.animateClippingWithCollision=function(e,t){this.animateWithCollision(this.animateEventWithClipping,e,t)},e.prototype.getHitsPositions=function(e){for(var t=[],n=0;n<e.length;n+=3)t.push(e.slice(n,n+3));return t},e}(),T=n(19),E=n(14),w=n(15),O=function(){function e(e,t,n){this.composer=new T.a(n),this.camera=e,this.scene=t,this.defaultRenderPass=new E.a(this.scene,this.camera),this.composer.addPass(this.defaultRenderPass)}return e.prototype.render=function(e,t){this.composer&&(this.defaultRenderPass.camera=e,this.defaultRenderPass.scene=t,this.composer.render())},e.prototype.addOutlinePassForSelection=function(){var e=new w.a(new c.Qb(window.innerWidth,window.innerHeight),this.scene,this.camera);return e.overlayMaterial.blending=c.gb,e.visibleEdgeColor.set(16777062),e.visibleEdgeColor.set(14635824),this.composer.addPass(e),e},e.prototype.removePass=function(e){var t=this.composer.passes.indexOf(e);this.composer.passes.splice(t,1)},e}(),S=function(){function e(){var e=this;this.currentVRSession=null,this.onVRSessionStarted=function(t){t.addEventListener("end",e.onVRSessionEnded),e.renderer.xr.setSession(t),e.currentVRSession=t},this.onVRSessionEnded=function(){var t,n;null===(t=e.currentVRSession)||void 0===t||t.removeEventListener("end",e.onVRSessionEnded),e.currentVRSession=null,null===(n=e.onSessionEnded)||void 0===n||n.call(e)}}return e.prototype.setVRSession=function(t,n){var r,o,i;if(this.renderer=t,this.onSessionEnded=n,null===(r=navigator)||void 0===r?void 0:r.xr){null===(i=null===(o=navigator)||void 0===o?void 0:o.xr)||void 0===i||i.requestSession(e.SESSION_TYPE,{optionalFeatures:["local-floor","bounded-floor","hand-tracking"]}).then(this.onVRSessionStarted),this.setupVRControls()}},e.prototype.endVRSession=function(){var e;null===(e=this.currentVRSession)||void 0===e||e.end()},e.prototype.getCameraGroup=function(e){return this.cameraGroup||(this.cameraGroup=new c.z),e&&(this.vrCamera=(new c.j).copy(e),this.vrCamera.name="VR_CAMERA",this.vrCamera.far=1e6,this.cameraGroup.position.copy(this.vrCamera.position),this.cameraGroup.add(this.vrCamera)),this.cameraGroup},e.prototype.getVRCamera=function(){return this.vrCamera},e.prototype.setupVRControls=function(){var e,t=this,n=new c.Rb;this.controller=this.renderer.xr.getController(0),this.controller.addEventListener("selectstart",(function(){e=setInterval((function(){t.moveInDirection(n,30)}),20)})),this.controller.addEventListener("selectend",(function(){clearInterval(e)}))},e.prototype.moveInDirection=function(e,t){var n;null===(n=this.renderer.xr.getCamera(new c.j))||void 0===n||n.getWorldDirection(e),this.cameraGroup.position.addScaledVector(e,t),this.vrCamera.position.addScaledVector(e,t)},e.SESSION_TYPE="immersive-vr",e}(),D=function(){function e(){this.ignoreList=[(new c.b).type,(new c.q).type,(new c.d).type],this.clipPlanes=[new c.mb(new c.Rb(0,1,0),0),new c.mb(new c.Rb(0,-1,0),0),new c.mb(new c.Rb(0,0,1),-15e3)]}return e.prototype.init=function(e,t){this.sceneManager=new C(this.ignoreList),this.exportManager=new d,this.importManager=new v(this.clipPlanes,C.EVENT_DATA_ID,C.GEOMETRIES_ID),this.rendererManager=new u(e.elementId),this.controlsManager=new h(this.rendererManager),this.effectsManager=new O(this.controlsManager.getMainCamera(),this.sceneManager.getScene(),this.rendererManager.getMainRenderer()),this.animationsManager=new M(this.sceneManager.getScene(),this.controlsManager.getActiveCamera(),this.rendererManager),this.vrManager=new S,this.infoLogger=t,this.getSelectionManager().init(this.controlsManager.getMainCamera(),this.sceneManager.getScene(),this.effectsManager,this.infoLogger),this.setConfiguration(e)},e.prototype.updateControls=function(){this.controlsManager.getActiveControls().update(),this.controlsManager.updateSync(),s.update()},e.prototype.render=function(){this.rendererManager.render(this.sceneManager.getScene(),this.controlsManager),this.effectsManager.render(this.controlsManager.getMainCamera(),this.sceneManager.getScene()),this.sceneManager.updateLights(this.controlsManager.getActiveCamera())},e.prototype.minimalRender=function(){this.rendererManager.getMainRenderer().render(this.sceneManager.getScene(),this.vrManager.getVRCamera())},e.prototype.getSceneManager=function(){return this.sceneManager||(this.sceneManager=new C(this.ignoreList)),this.sceneManager},e.prototype.autoRotate=function(e){this.controlsManager.getActiveControls().autoRotate=e},e.prototype.setClipping=function(e){this.rendererManager.setLocalClippingEnabled(e)},e.prototype.rotateClipping=function(e){var t=new c.tb;t.setFromAxisAngle(new c.Rb(0,0,1),e*Math.PI/180),this.clipPlanes[0].normal.set(0,1,0).applyQuaternion(t)},e.prototype.animateCameraTransform=function(e,t,n){this.animateCameraPosition(e,n),this.animateCameraTarget(t,n)},e.prototype.swapCameras=function(e){var t;t=e?"OrthographicCamera":"PerspectiveCamera",this.controlsManager.getMainCamera().type!==t&&this.controlsManager.swapControls()},e.prototype.loadOBJGeometry=function(e,t,n,r,o){void 0===o&&(o=!0);var i=this.sceneManager.getGeometries();this.importManager.loadOBJGeometry((function(e){e.visible=o,i.add(e)}),e,t,n,r)},e.prototype.loadGLTFGeometry=function(e,t,n,r){void 0===r&&(r=!0);var o=this.sceneManager.getGeometries();this.importManager.loadGLTFGeometry(e,t,(function(e){e.visible=r,o.add(e)}),n)},e.prototype.parseOBJGeometry=function(e,t,n){void 0===n&&(n=!0);var r=this.sceneManager.getGeometries(),o=this.importManager.parseOBJGeometry(e,t);o.visible=n,r.add(o)},e.prototype.parseGLTFGeometry=function(e){var t=this;this.importManager.parseGLTFGeometry(e,(function(e,n){t.sceneManager.getScene().add(e),t.sceneManager.getScene().add(n)}))},e.prototype.loadJSONGeometry=function(e,t,n,r,o){void 0===o&&(o=!0);var i=this.sceneManager.getGeometries();this.importManager.loadJSONGeometry(e,t,(function(e){e.visible=o,i.add(e)}),n,r)},e.prototype.exportSceneToOBJ=function(){var e=this.sceneManager.getCleanScene();this.exportManager.exportSceneToOBJ(e)},e.prototype.exportPhoenixScene=function(){var e=this.sceneManager.getCleanScene();this.exportManager.exportPhoenixScene(e,this.sceneManager.getEventData(),this.sceneManager.getGeometries())},e.prototype.fixOverlayView=function(e){this.rendererManager.setFixOverlay(e)},e.prototype.setSelectedObjectDisplay=function(e){this.getSelectionManager().setSelectedObject(e)},e.prototype.eventDataDepthTest=function(e){this.sceneManager.eventDataDepthTest(e)},e.prototype.enableSelecting=function(e){this.getSelectionManager().setSelecting(e)},e.prototype.clearEventData=function(){this.sceneManager.clearEventData()},e.prototype.addEventDataTypeGroup=function(e){return this.sceneManager.addEventDataTypeGroup(e)},e.prototype.setOverlayRenderer=function(e){this.rendererManager&&this.rendererManager.setOverlayRenderer(e)},e.prototype.zoomTo=function(e,t){this.controlsManager.zoomTo(e,t)},e.prototype.setConfiguration=function(e){},e.prototype.getSelectionManager=function(){return this.selectionManager||(this.selectionManager=new b),this.selectionManager},e.prototype.animateCameraPosition=function(e,t){var n=new s.Tween(this.controlsManager.getActiveCamera().position);n.to({x:e[0],y:e[1],z:e[2]},t),n.start()},e.prototype.animateCameraTarget=function(e,t){var n=new s.Tween(this.controlsManager.getActiveControls().target);n.to({x:e[0],y:e[1],z:e[2]},t),n.start()},e.prototype.getActiveObjectId=function(){return this.getSelectionManager().getActiveObjectId()},e.prototype.lookAtObject=function(e){this.controlsManager.lookAtObject(e,this.getSceneManager().getEventData())},e.prototype.highlightObject=function(e){this.selectionManager.highlightObject(e,this.getSceneManager().getEventData())},e.prototype.enableKeyboardControls=function(){var e=this;document.addEventListener("keydown",(function(t){if(t.shiftKey)switch(t.code){case"KeyR":e.autoRotate(!e.controlsManager.getActiveControls().autoRotate);break;case"Equal":e.zoomTo(1/1.2,100);break;case"Minus":e.zoomTo(1.2,100);break;case"KeyC":e.setClipping(!e.rendererManager.getLocalClipping()),e.rendererManager.getLocalClipping()&&e.rotateClipping(180);break;case"KeyV":var n="OrthographicCamera"===e.controlsManager.getMainCamera().type;e.swapCameras(!n)}}))},e.prototype.animateThroughEvent=function(e,t,n){this.animationsManager.animateThroughEvent(e,t,n)},e.prototype.animateEventWithCollision=function(e,t){this.animationsManager.animateEventWithCollision(e,t)},e.prototype.animateClippingWithCollision=function(e,t){this.animationsManager.animateClippingWithCollision(e,t)},e.prototype.initVRSession=function(e){var t=this,n=this.vrManager.getCameraGroup(this.controlsManager.getMainCamera());this.sceneManager.getScene().add(n);var r=this.rendererManager.getMainRenderer();r.xr.enabled=!0;r.setAnimationLoop((function(){t.minimalRender()})),this.vrManager.setVRSession(r,e)},e.prototype.endVRSession=function(){this.sceneManager.getScene().remove(this.vrManager.getCameraGroup());var e=this.rendererManager.getMainRenderer();e.xr.enabled=!1,e.setAnimationLoop(null),this.vrManager.endVRSession()},e}(),x=n(16),L=n(17),j=function(){function e(e){this.three=e,this.guiParameters={rotate:void 0,axis:void 0,lowRes:void 0,eventData:void 0,geometries:void 0},this.geomFolderAdded=!1,this.maxPositionX=4e3,this.maxPositionY=4e3,this.maxPositionZ=4e3}return e.prototype.showUI=function(e){this.clearUI(),this.configuration=e,this.showStats(e.elementId),e.enableDatGUIMenu&&this.showDatGUIMenu(e.elementId),this.detectColorScheme(),e.phoenixMenuRoot&&this.showPhoenixMenu(e.getPhoenixMenuRoot())},e.prototype.showStats=function(e){this.stats=x(),this.stats.showPanel(0),this.stats.dom.className="ui-element",this.stats.domElement.style.cssText="position: absolute; left: 0px; cursor: pointer; opacity: 0.9; z-index: 10; bottom: 0px;";var t=document.getElementById(e);null==t&&(t=document.body),t.appendChild(this.stats.dom)},e.prototype.updateUI=function(){this.stats.update()},e.prototype.showDatGUIMenu=function(e){this.hasDatGUIMenu=!0,this.gui=new L.a,this.gui.domElement.id="gui",this.gui.domElement.style.cssText="position: absolute; right: 0; top: 2rem; z-index: 11;",this.canvas=document.getElementById(e),null==this.canvas&&(this.canvas=document.body),this.canvas.appendChild(this.gui.domElement),this.geomFolder=null,this.eventFolder=null},e.prototype.showPhoenixMenu=function(e){this.setPhoenixMenu(e),this.hasPhoenixMenu=!0,this.geomFolderPM=null,this.eventFolderPM=null},e.prototype.clearUI=function(){this.clearDatGUI(),this.clearPhoenixMenu()},e.prototype.clearDatGUI=function(){var e=document.getElementById("gui");null!=e&&e.remove(),this.geomFolder=null,this.geomFolderAdded=!1,this.hasDatGUIMenu=!1},e.prototype.clearPhoenixMenu=function(){this.phoenixMenu&&(this.phoenixMenu.truncate(),this.phoenixMenu=void 0),this.geomFolderPM=null,this.eventFolderPM=null,this.geomFolderAdded=!1,this.hasPhoenixMenu=!1},e.prototype.addGeomFolder=function(){var e=this;(this.geomFolderAdded=!0,this.hasDatGUIMenu)&&(null==this.geomFolder&&(this.geomFolder=this.gui.addFolder(C.GEOMETRIES_ID)),this.guiParameters.geometries={show:!0,wireframe:!1},this.geomFolder.add(this.guiParameters.geometries,"show").name("Show").listen().onChange((function(t){e.three.getSceneManager().objectVisibility(C.GEOMETRIES_ID,t)})),this.geomFolder.add(this.guiParameters.geometries,"wireframe").name("Wireframe").listen().onChange((function(t){e.three.getSceneManager().wireframeGeometries(t)})));this.hasPhoenixMenu&&(null==this.geomFolderPM&&(this.geomFolderPM=this.phoenixMenu.addChild("Detector",(function(t){e.three.getSceneManager().groupVisibility(C.GEOMETRIES_ID,t)}),"perspective")),this.geomFolderPM.addConfig("checkbox",{label:"Wireframe",isChecked:!1,onChange:function(t){e.three.getSceneManager().wireframeGeometries(t)}}).addConfig("slider",{label:"Opacity",min:0,max:1,step:.01,allowCustomValue:!0,onChange:function(t){e.three.getSceneManager().setGeometryOpacity(C.GEOMETRIES_ID,t)}}).addConfig("slider",{label:"Scale",min:0,max:20,step:.01,allowCustomValue:!0,onChange:function(t){e.three.getSceneManager().scaleObject(name,t)}}))},e.prototype.geometryVisibility=function(e,t){this.three.getSceneManager().objectVisibility(e,t)},e.prototype.addGeometry=function(e,t,n){var r=this;if(void 0===n&&(n=!0),this.geomFolderAdded||this.addGeomFolder(),this.hasDatGUIMenu){this.guiParameters[e]={show:n,color:t,x:0,y:0,z:0,detectorOpacity:1,remove:this.removeOBJ(e),scale:1};var o=this.geomFolder.addFolder(e);o.addColor(this.guiParameters[e],"color").name("Color").onChange((function(t){return r.three.getSceneManager().OBJGeometryColor(e,t)})),o.add(this.guiParameters[e],"detectorOpacity",0,1).name("Opacity").onFinishChange((function(t){return r.three.getSceneManager().setGeometryOpacity(e,t)})),o.add(this.guiParameters[e],"show").name("Show").listen().onChange((function(t){return r.three.getSceneManager().objectVisibility(e,t)})),o.add(this.guiParameters[e],"scale",0,1e3).name("Scale").onChange((function(t){r.three.getSceneManager().scaleObject(e,t)})),o.add(this.guiParameters[e],"x",-this.maxPositionX,this.maxPositionX).name("X").onChange((function(t){return r.three.getSceneManager().getObjectPosition(e).setX(t)})),o.add(this.guiParameters[e],"y",-this.maxPositionY,this.maxPositionY).name("Y").onChange((function(t){return r.three.getSceneManager().getObjectPosition(e).setY(t)})),o.add(this.guiParameters[e],"z",-this.maxPositionZ,this.maxPositionZ).name("Z").onChange((function(t){return r.three.getSceneManager().getObjectPosition(e).setZ(t)})),o.add(this.guiParameters[e],"remove").name("Remove")}if(this.hasPhoenixMenu){var i=this.geomFolderPM.addChild(e,(function(t){r.three.getSceneManager().objectVisibility(e,t)}));i.toggleState=n,i.addConfig("color",{label:"Color",onChange:function(t){r.three.getSceneManager().OBJGeometryColor(e,t)}}).addConfig("slider",{label:"Opacity",min:0,max:1,step:.05,allowCustomValue:!0,onChange:function(t){r.three.getSceneManager().setGeometryOpacity(e,t)}})}},e.prototype.removeOBJ=function(e){var t=this;return function(){var n=t.geomFolder.__folders[e];n&&t.geomFolder.removeFolder(n),t.three.getSceneManager().removeGeometry(e)}},e.prototype.addEventDataFolder=function(){var e=this;this.hasDatGUIMenu&&(null!=this.eventFolder&&this.gui.removeFolder(this.eventFolder),this.eventFolder=this.gui.addFolder("Event Data"),this.guiParameters.eventData={show:!0,depthTest:!0},this.eventFolder.add(this.guiParameters.eventData,"show").name("Show").listen().onChange((function(t){return e.three.getSceneManager().objectVisibility(C.EVENT_DATA_ID,t)})),this.eventFolder.add(this.guiParameters.eventData,"depthTest").name("Depth Test").listen().onChange((function(t){return e.three.eventDataDepthTest(t)})));this.hasPhoenixMenu&&(null!=this.eventFolderPM&&this.eventFolderPM.remove(),this.eventFolderPM=this.phoenixMenu.addChild("Event Data",(function(t){e.three.getSceneManager().groupVisibility(C.EVENT_DATA_ID,t)}),"event-folder"),this.eventFolderPM.addConfig("checkbox",{label:"Depth Test",isChecked:!0,onChange:function(t){e.three.eventDataDepthTest(t)}}))},e.prototype.getEventDataFolder=function(){return this.eventFolder},e.prototype.addEventDataTypeFolder=function(e,t){var n=this;if(this.hasDatGUIMenu){var r=this.eventFolder.addFolder(e);return this.guiParameters.eventData[e]=!0,r.add(this.guiParameters.eventData,e).name("Show").listen().onChange((function(t){return n.three.getSceneManager().objectVisibility(e,t)})),null===t||void 0===t||t(r),r}},e.prototype.addEventDataTypeFolderPM=function(e,t){var n=this;if(this.hasPhoenixMenu){var r=this.eventFolderPM.addChild(e,(function(t){n.three.getSceneManager().objectVisibility(e,t)}));return null===t||void 0===t||t(void 0,r),r}},e.prototype.addCollection=function(e,t,n){var r=this;if(e&&this.hasDatGUIMenu){this.guiParameters[t]={show:!0,color:0,resetCut:function(){return r.three.getSceneManager().groupVisibility(t,!0,C.EVENT_DATA_ID)}};var o=e.addFolder(t);if(o.add(this.guiParameters[t],"show").name("Show").listen().onChange((function(e){return r.three.getSceneManager().objectVisibility(t,e,C.EVENT_DATA_ID)})),o.addColor(this.guiParameters[t],"color").name("Color").onChange((function(e){return r.three.getSceneManager().collectionColor(t,e)})),n){var i=o.addFolder("Cuts");i.add(this.guiParameters[t],"resetCut").name("Reset cuts");for(var a=function(e){i.add(e,"minValue",e.minValue,e.maxValue).name("min "+e.field).onChange((function(n){r.three.getSceneManager().collectionFilter(t,e)})),i.add(e,"maxValue",e.minValue,e.maxValue).name("max "+e.field).onChange((function(n){r.three.getSceneManager().collectionFilter(t,e)}))},s=0,c=n;s<c.length;s++){a(c[s])}}}},e.prototype.addCollectionPM=function(e,t,n){var r=this;if(this.hasPhoenixMenu){var o=e.addChild(t,(function(e){r.three.getSceneManager().objectVisibility(t,e,C.EVENT_DATA_ID)}));if(o.addConfig("color",{label:"Color",onChange:function(e){r.three.getSceneManager().collectionColor(t,e)}}),n){o.addConfig("label",{label:"Cuts"}).addConfig("button",{label:"Reset cuts",onClick:function(){r.three.getSceneManager().groupVisibility(t,!0,C.EVENT_DATA_ID)}});for(var i=function(e){o.addConfig("slider",{label:"Min "+e.field,min:e.minValue,max:e.maxValue,allowCustomValue:!0,onChange:function(n){e.minValue=n,r.three.getSceneManager().collectionFilter(t,e)}}).addConfig("slider",{label:"Max "+e.field,min:e.minValue,max:e.maxValue,allowCustomValue:!0,onChange:function(n){e.maxValue=n,r.three.getSceneManager().collectionFilter(t,e)}})},a=0,s=n;a<s.length;a++){i(s[a])}}}},e.prototype.rotateClipping=function(e){this.three.rotateClipping(e)},e.prototype.setClipping=function(e){this.three.setClipping(e)},e.prototype.detectColorScheme=function(){var e=!1;localStorage.getItem("theme")?"dark"===localStorage.getItem("theme")&&(e=!0):window.matchMedia&&matchMedia("(prefers-color-scheme: dark)").matches&&(e=!0),this.darkTheme=e,this.setDarkTheme(e)},e.prototype.setDarkTheme=function(e){e?(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-theme","dark")):(localStorage.setItem("theme","light"),document.documentElement.setAttribute("data-theme","light")),this.darkTheme=e,this.three.getSceneManager().darkBackground(e)},e.prototype.getDarkTheme=function(){return this.darkTheme},e.prototype.setAutoRotate=function(e){this.three.autoRotate(e)},e.prototype.setShowAxis=function(e){this.three.getSceneManager().setAxis(e)},e.prototype.getPresetViews=function(){if(this.configuration)return this.configuration.presetViews},e.prototype.displayView=function(e){this.three.animateCameraTransform(e.cameraPos,[0,0,0],1e3)},e.prototype.toggleOrthographicView=function(e){this.three.swapCameras(e)},e.prototype.setOverlayRenderer=function(e){this.three.setOverlayRenderer(e)},e.prototype.setPhoenixMenu=function(e){this.phoenixMenu&&(this.phoenixMenu.truncate(),this.phoenixMenu=void 0),this.phoenixMenu=e},e.prototype.enableKeyboardControls=function(){var e=this;document.addEventListener("keydown",(function(t){if(t.shiftKey){switch(t.code){case"KeyT":e.setDarkTheme(!e.getDarkTheme())}if(t.code.startsWith("Digit")){var n=parseInt(t.code.slice(-1))-1;e.configuration.presetViews[n]&&e.displayView(e.configuration.presetViews[n])}}}))},e}(),P=function(){function e(){this.infoLoggerList=[],this.maxEntries=10}return e.prototype.add=function(e,t){this.infoLoggerList.length>this.maxEntries&&this.infoLoggerList.pop(),this.infoLoggerList.unshift(t?t+": "+e:e)},e.prototype.getInfoLoggerList=function(){return this.infoLoggerList},e}(),R=function(){function e(){this.onEventsChange=[],this.onDisplayedEventChange=[],this.graphicsLibrary=new D,this.infoLogger=new P,this.ui=new j(this.graphicsLibrary)}return e.prototype.init=function(e){var t=this;this.configuration=e,this.graphicsLibrary.init(e,this.infoLogger),this.ui.showUI(e),this.frameID&&cancelAnimationFrame(this.frameID);!function e(){t.frameID=requestAnimationFrame(e),t.graphicsLibrary.updateControls(),t.ui.updateUI(),t.graphicsLibrary.render()}(),this.enableEventDisplayConsole(),this.enableKeyboardControls()},e.prototype.initVR=function(e){this.graphicsLibrary.initVRSession(e)},e.prototype.endVR=function(){this.graphicsLibrary.endVRSession()},e.prototype.parsePhoenixEvents=function(e){this.eventsData=e;var t=this.configuration.getEventDataLoader().getEventsList(e);return this.loadEvent(t[0]),this.onEventsChange.forEach((function(e){return e(t)})),t},e.prototype.buildEventDataFromJSON=function(e){this.ui.addEventDataFolder(),this.graphicsLibrary.clearEventData(),this.configuration.getEventDataLoader().buildEventData(e,this.graphicsLibrary,this.ui,this.infoLogger),this.onDisplayedEventChange.forEach((function(t){return t(e)}))},e.prototype.loadEvent=function(e){var t=this.eventsData[e];t&&this.buildEventDataFromJSON(t)},e.prototype.getThreeManager=function(){return this.graphicsLibrary},e.prototype.getUIManager=function(){return this.ui},e.prototype.getInfoLogger=function(){return this.infoLogger},e.prototype.loadOBJGeometry=function(e,t,n,r,o){void 0===o&&(o=!0),this.graphicsLibrary.loadOBJGeometry(e,t,n,r,o),this.ui.addGeometry(t,n,o),this.infoLogger.add(t,"Loaded OBJ geometry")},e.prototype.parseOBJGeometry=function(e,t,n){void 0===n&&(n=!0),this.graphicsLibrary.parseOBJGeometry(e,t,n),this.ui.addGeometry(t,4095,n)},e.prototype.exportToOBJ=function(){this.graphicsLibrary.exportSceneToOBJ(),this.infoLogger.add("Exported scene to OBJ")},e.prototype.parsePhoenixDisplay=function(e){var t=JSON.parse(e);t.sceneConfiguration&&t.scene&&(this.ui.addEventDataFolder(),this.graphicsLibrary.clearEventData(),this.loadSceneConfiguration(t.sceneConfiguration),this.graphicsLibrary.parseGLTFGeometry(t.scene))},e.prototype.exportPhoenixDisplay=function(){this.graphicsLibrary.exportPhoenixScene()},e.prototype.parseGLTFGeometry=function(e){var t=JSON.parse(e);this.graphicsLibrary.parseGLTFGeometry(t)},e.prototype.loadGLTFGeometry=function(e,t,n,r){void 0===r&&(r=!0),this.graphicsLibrary.loadGLTFGeometry(e,t,n,r),this.ui.addGeometry(t,16711680,r),this.infoLogger.add(t,"Loaded GLTF geometry")},e.prototype.loadJSONGeometry=function(e,t,n,r,o){void 0===o&&(o=!0),this.graphicsLibrary.loadJSONGeometry(e,t,n,r,o),this.ui.addGeometry(t,16711680,o),this.infoLogger.add(t,"Loaded JSON geometry")},e.prototype.loadRootJSONGeometry=function(e,t,n,r,o,i){var a=this;void 0===i&&(i=!0),e.NewHttpRequest(t,"object",(function(t){a.loadJSONGeometry(e.GEO.build(t,{dflt_colors:!0}).toJSON(),n,r,o,i)})).send()},e.prototype.loadRootGeometry=function(e,t,n,r,o,i,a){var s=this;void 0===a&&(a=!0),t.indexOf(".root")>0&&e.OpenFile(t,(function(t){t.ReadObject(n,(function(t){s.loadJSONGeometry(e.GEO.build(t,{dflt_colors:!0}).toJSON(),r,o,i,a)}))}))},e.prototype.zoomTo=function(e,t){this.graphicsLibrary.zoomTo(e,t)},e.prototype.loadSceneConfiguration=function(e){for(var t=0,n=Object.keys(e.eventData);t<n.length;t++)for(var r=n[t],o=this.ui.addEventDataTypeFolder(r),i=0,a=e.eventData[r];i<a.length;i++){var s=a[i];this.ui.addCollection(o,s)}for(var c=0,l=e.geometries;c<l.length;c++){var h=l[c];this.ui.addGeometry(h,"#ffffff")}},e.prototype.getCollection=function(e){return this.configuration.getEventDataLoader().getCollection(e)},e.prototype.getCollections=function(){return this.configuration.getEventDataLoader().getCollections()},e.prototype.listenToDisplayedEventChange=function(e){this.onDisplayedEventChange.push(e)},e.prototype.listenToLoadedEventsChange=function(e){this.onEventsChange.push(e)},e.prototype.getEventMetadata=function(){return this.configuration.getEventDataLoader().getEventMetadata()},e.prototype.enableEventDisplayConsole=function(){var e=this;window.EventDisplay={loadGLTFGeometry:function(t,n){e.loadGLTFGeometry(t,n)},loadOBJGeometry:function(t,n,r,o){e.loadOBJGeometry(t,n,r,o)},loadJSONGeometry:function(t,n,r,o,i){void 0===i&&(i=!0),e.loadJSONGeometry(t,n,r,o,i)}}},e.prototype.renderOverlay=function(e){this.graphicsLibrary.setOverlayRenderer(e)},e.prototype.allowSelection=function(e){this.graphicsLibrary.setSelectedObjectDisplay(e)},e.prototype.enableSelecting=function(e){this.graphicsLibrary.enableSelecting(e)},e.prototype.fixOverlayView=function(e){this.graphicsLibrary.fixOverlayView(e)},e.prototype.getActiveObjectId=function(){return this.graphicsLibrary.getActiveObjectId()},e.prototype.lookAtObject=function(e){this.graphicsLibrary.lookAtObject(e),this.graphicsLibrary.highlightObject(e)},e.prototype.highlightObject=function(e){this.graphicsLibrary.highlightObject(e)},e.prototype.enableKeyboardControls=function(){this.ui.enableKeyboardControls(),this.graphicsLibrary.enableKeyboardControls()},e.prototype.animateThroughEvent=function(e,t,n){this.graphicsLibrary.animateThroughEvent(e,t,n)},e.prototype.animateEventWithCollision=function(e,t){this.graphicsLibrary.animateEventWithCollision(e,t)},e.prototype.animateClippingWithCollision=function(e,t){this.graphicsLibrary.animateClippingWithCollision(e,t)},e}(),_=(function(){function e(e,t,n,r,o,i){this.toggleState=!0,this.children=[],this.configs=[],this.nodeLevel=0,this.childrenActive=!1,this.configActive=!1,this.name=e,this.icon=t,this.onToggle=n,r&&(this.children=r),o&&(this.configs=o),i&&(this.parent=i)}e.prototype.addChild=function(t,n,r){var o=new e(t,r,n);return o.parent=this,o.nodeLevel=this.nodeLevel+1,this.children.push(o),o},e.prototype.removeChild=function(e){var t=this.children.indexOf(e);return this.children.splice(t,1),this},e.prototype.remove=function(){this.parent?this.parent.removeChild(this):console.error("Cannot delete root node of phoenix menu. Set it to undefined/null instead.")},e.prototype.truncate=function(){this.children=[]},e.prototype.addConfig=function(e,t){var n={type:e};return Object.assign(n,t),this.configs.push(n),this},e.prototype.toggleSelfAndDescendants=function(e){var t;null===(t=this.onToggle)||void 0===t||t.call(this,e),this.toggleState=e;for(var n=0,r=this.children;n<r.length;n++){r[n].toggleSelfAndDescendants(e)}}}(),function(e,t,n){this.field=e,this.minValue=t,this.maxValue=n}),k=function(){function e(){}return e.step=function(e){for(var t,n,r,o,i,a,s,c=e.q/(e.unitC*e.p),l=A.get(e.pos),h=e.dir.clone().cross(l).multiplyScalar(c),u=function(l){t=l*l,n=l/2;var u=e.pos.clone().add(e.dir.clone().multiplyScalar(n)).add(h.clone().multiplyScalar(t/8));r=A.get(u),i=e.dir.clone().add(h.clone().multiplyScalar(n)).cross(r).multiplyScalar(c),a=e.dir.clone().add(i.clone().multiplyScalar(n)).cross(r).multiplyScalar(c);var p=e.pos.clone().add(e.dir.clone().multiplyScalar(l)).add(a.clone().multiplyScalar(t/2));o=A.get(p),s=e.dir.clone().add(a.clone().multiplyScalar(l)).cross(o).multiplyScalar(c);var g=h.clone().sub(i).sub(a).add(s);return l*(Math.abs(g.x)+Math.abs(g.y)+Math.abs(g.z))},p=u(e.stepSize);p>2e-4;)e.stepSize*=.5,p=u(e.stepSize);var g=e.stepSize,d=Math.pow(g,2);return e.pos.add(e.dir.clone().multiplyScalar(g)).add(h.clone().add(i).add(a).multiplyScalar(d/6)),e.dir.add(h.clone().add(i.clone().multiplyScalar(2)).add(a.clone().multiplyScalar(2)).add(s).multiplyScalar(g/6)),e.dir.normalize(),e.stepSize},e.propagate=function(t,n,r,o,i,a){void 0===i&&(i=-1),void 0===a&&(a=1e3);var s=new G;s.pos=t,s.dir=n,s.p=r,s.q=o,s.maxStepSize=i;for(var c=[];s.pathLength<a;){s.pathLength+=e.step(s);var l=JSON.parse(JSON.stringify(s));c.push({pos:l.pos,dir:l.dir})}return c},e}(),G=function(){this.pos=new c.Rb(0,0,0),this.dir=new c.Rb(0,0,0),this.p=0,this.q=1,this.unitC=3.3333,this.stepSize=1e3,this.maxStepSize=10,this.pathLength=0},A=function(){function e(){}return e.get=function(e){return new c.Rb(0,0,2)},e}(),N=function(){function e(){}return e.getTracksWithRungeKutta=function(t){for(var n=Object.assign({},t),r=0,o=Object.keys(n);r<o.length;r++)for(var i=0,a=n[o[r]];i<a.length;i++){var s=a[i];s.pos=e.extrapolateTrackPositions(s)}return{}},e.extrapolateTrackPositions=function(e){var t,n=e.dparams,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4];t=0!==s?Math.abs(1/s):0;var l=Math.round(t*s),h=new c.Rb(t*Math.cos(i)*Math.sin(a),t*Math.sin(i)*Math.sin(a),t*Math.cos(a)),u=new c.Rb(-r*Math.sin(i),r*Math.cos(i),o),p=[];p.push([u.x,u.y,u.z]);var g=h.clone();g.normalize();var d=k.propagate(u,g,t,l,10,2500).map((function(e){return[e.pos.x,e.pos.y,e.pos.z]}));return p.concat(d)},e}(),V=function(){function e(){}return e.getTrack=function(e){var t=e.pos;if(t){if(t.length<3){if(!(null===e||void 0===e?void 0:e.dparams))return;t=N.extrapolateTrackPositions(e)}var n=16711680;e.color&&(n=parseInt(e.color,16));for(var r=[],o=0;o<t.length;o++)r.push(new c.Rb(t[o][0],t[o][1],t[o][2]));var i=new c.l(r),a=new c.Ob(i,void 0,2),s=new c.ab({color:n}),l=new c.U(a,s),h=i.getPoints(50),u=(new c.i).setFromPoints(h),p=new c.H({color:n,linewidth:2}),g=new c.G(u,p);g.name="Track";var d=new c.z;d.add(l),d.add(g);for(var m=0,f=[l,d];m<f.length;m++){var v=f[m];v.userData=e,v.name="Track"}return e.uuid=l.uuid,d}},e.getJet=function(e){var t=e.eta,n=e.phi,r=e.theta?e.theta:2*Math.atan(Math.pow(Math.E,t)),o=.2*(e.energy?e.energy:e.et);o>3e3&&(o=3e3);var i=.1*o,a=Math.sin(n),s=Math.cos(n),l=Math.sin(r),h=Math.cos(r),u=new c.Rb(.5*o*s*l,.5*o*a*l,.5*o*h),p=s*l,g=a*l,d=h,m=new c.Rb(0,1,0),f=new c.Rb(p,g,d),v=new c.tb;v.setFromUnitVectors(m,f);var y=new c.p(i,1,o,50,50,!1),b=new c.V({color:2200782,opacity:.3,transparent:!0});b.opacity=.5;var C=new c.U(y,b);return C.position.copy(u),C.quaternion.copy(v),C.userData=e,C.name="Jet",e.uuid=C.uuid,C},e.getHits=function(e){var t,n;"object"!==typeof e||Array.isArray(e)?(t=e,n={pos:e}):(t=[e.pos],n=e);for(var r=new Float32Array(3*t.length),o=0,i=0,a=t;i<a.length;i++){var s=a[i];r[o]=s[0],r[o+1]=s[1],r[o+2]=s[2],o+=3}var l=new c.i;l.setAttribute("position",new c.h(r,3)),l.computeBoundingSphere();var h=new c.qb({size:10});h.color.set("#ff0000");var u=new c.pb(l,h);return u.userData=n,u.userData.uuid=u.uuid,u.name="Hit",e.uuid=u.uuid,u},e.getCluster=function(e){var t=.003*e.energy,n=new c.g(30,30,t),r=new c.X({color:16765286}),o=new c.U(n,r),i=2*Math.atan(Math.pow(Math.E,e.eta)),a=new c.Rb(4e3*Math.cos(e.phi)*Math.sin(i),4e3*Math.sin(e.phi)*Math.sin(i),4e3*Math.cos(i));return o.position.x=a.x,o.position.y=a.y,a.x*a.x+a.y*a.y>121e4&&(o.position.x=1100*Math.cos(e.phi),o.position.y=1100*Math.sin(e.phi)),o.position.z=Math.max(Math.min(a.z,3200),-3200),o.lookAt(new c.Rb(0,0,0)),o.userData=e,o.name="Cluster",e.uuid=o.uuid,o},e}(),B=function(){function e(){}return e.prototype.buildEventData=function(e,t,n,r){this.graphicsLibrary=t,this.ui=n,this.eventData=e,this.loadObjectTypes(e);var o=e["event number"]?e["event number"]:e.eventNumber,i=e["run number"]?e["run number"]:e.runNumber;r.add("Event#"+o+" from run#"+i,"Loaded")},e.prototype.getEventsList=function(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];null!==e[o]&&t.push(o)}return t},e.prototype.getCollections=function(){if(!this.eventData)return null;for(var e=[],t=0,n=Object.keys(this.eventData);t<n.length;t++){var r=n[t];if(this.eventData[r]&&"object"===typeof this.eventData[r])for(var o=0,i=Object.keys(this.eventData[r]);o<i.length;o++){var a=i[o];e.push(a)}}return e},e.prototype.getCollection=function(e){if(!this.eventData)return null;for(var t=0,n=Object.keys(this.eventData);t<n.length;t++){var r=n[t];if(this.eventData[r])for(var o=0,i=Object.keys(this.eventData[r]);o<i.length;o++){var a=i[o];if(a===e)return this.eventData[r][a]}}},e.prototype.loadObjectTypes=function(e){var t=this;if(e.Tracks){var n=[new _("chi2",0,50),new _("dof",0,100),new _("mom",0,500)];this.addObjectType(e.Tracks,V.getTrack,"Tracks",n)}if(e.Jets){n=[new _("phi",-Math.PI,Math.PI),new _("eta",0,100),new _("energy",2e3,1e4)];this.addObjectType(e.Jets,V.getJet,"Jets",n,(function(e,n){e&&e.add({jetsScale:100},"jetsScale",1,200).name("Jets Size (%)").onChange((function(e){t.graphicsLibrary.getSceneManager().scaleJets(e)}));n&&n.addConfig("slider",{label:"Jets Size (%)",min:1,max:200,allowCustomValue:!0,onChange:function(e){t.graphicsLibrary.getSceneManager().scaleJets(e)}})}))}if(e.Hits&&this.addObjectType(e.Hits,V.getHits,"Hits"),e.CaloClusters){n=[new _("phi",-Math.PI,Math.PI),new _("eta",0,100),new _("energy",2e3,1e4)];this.addObjectType(e.CaloClusters,V.getCluster,"CaloClusters",n)}e.Muons&&this.addObjectType(e.Muons,this.getMuon,"Muons")},e.prototype.addObjectType=function(e,t,n,r,o){for(var i=this.ui.addEventDataTypeFolder(n,o),a=this.ui.addEventDataTypeFolderPM(n,o),s=this.graphicsLibrary.addEventDataTypeGroup(n),c=this.getObjectTypeCollections(e),l=function(n){var o=e[n];h.addCollection(o,n,t,s),r=null===r||void 0===r?void 0:r.filter((function(e){return o[0][e.field]})),h.ui.addCollection(i,n,r),h.ui.addCollectionPM(a,n,r)},h=this,u=0,p=c;u<p.length;u++){l(p[u])}},e.prototype.addCollection=function(e,t,n,r){var o=new c.z;o.name=t;for(var i=0,a=e;i<a.length;i++){var s=a[i],l=n.bind(this)(s);l&&o.add(l)}r.add(o)},e.prototype.getObjectTypeCollections=function(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];null!==e[o]&&t.push(o)}return t},e.prototype.getMuon=function(e){for(var t=new c.z,n=0,r=e.LinkedClusters;n<r.length;n++){var o=r[n],i=o.split(":")[0],a=o.split(":")[1];if(i&&a&&this.eventData.CaloClusters&&this.eventData.CaloClusters[i]){var s=this.eventData.CaloClusters[i][a];if(s){var l=V.getCluster(s);t.add(l)}}}for(var h=0,u=e.LinkedTracks;h<u.length;h++){var p=u[h],g=p.split(":")[0],d=p.split(":")[1];if(g&&d&&this.eventData.Tracks&&this.eventData.Tracks[g]){var m=this.eventData.Tracks[g][d];if(m){var f=V.getTrack(m);t.add(f)}}}return e.uuid=t.uuid,t.name="Muon",t},e.prototype.getEventMetadata=function(){for(var e=[],t=Object.keys(this.eventData),n=0,r=[[{keys:["runNumber","run number"],label:"Run"},{keys:["eventNumber","event number"],label:"Event"},{keys:["ls"],label:"LS"},{keys:["lumiBlock"],label:"LumiBlock"}],[{keys:["time"],label:"Data recorded"}]];n<r.length;n++){for(var o={},i=0,a=r[n];i<a.length;i++)for(var s=a[i],c=0,l=s.keys;c<l.length;c++){var h=l[c];if(t.includes(h)&&this.eventData[h]){o[s.label]=this.eventData[h];break}}Object.keys(o).length>0&&e.push({label:Object.keys(o).join(" / "),value:Object.values(o).join(" / ")})}return e},e}(),I=function(){function e(e,t){void 0===e&&(e="eventDisplay"),void 0===t&&(t=!1),this.elementId=e,this.presetViews=[],this.eventDataLoader=new B,this.enableDatGUIMenu=t}return e.prototype.anyPresetView=function(){return this.presetViews.length>0},e.prototype.setEventDataLoader=function(e){this.eventDataLoader=e},e.prototype.getEventDataLoader=function(){return this.eventDataLoader},e.prototype.setPhoenixMenuRoot=function(e){this.phoenixMenuRoot=e},e.prototype.getPhoenixMenuRoot=function(){return this.phoenixMenuRoot},e}(),F=(function(){function e(e,t,n){this.name=e,this.cameraPos=t,this.icon=n}e.prototype.getIconURL=function(){return"assets/preset-views/"+this.icon+".svg#"+this.icon}}(),function(){function e(){}return e.getMuonChamber=function(e){for(var t=[],n=[],r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];i.startsWith("front")?t.push((new c.Rb).fromArray(e[i])):i.startsWith("back")&&n.push((new c.Rb).fromArray(e[i]))}var a=new c.y;a.vertices=t.concat(n),a.faces.push(new c.u(0,1,2)),a.faces.push(new c.u(2,3,0)),a.faces.push(new c.u(4,5,6)),a.faces.push(new c.u(6,7,4)),a.faces.push(new c.u(4,5,1)),a.faces.push(new c.u(1,0,4)),a.faces.push(new c.u(7,6,2)),a.faces.push(new c.u(2,3,7)),a.faces.push(new c.u(0,3,7)),a.faces.push(new c.u(7,4,0)),a.faces.push(new c.u(1,5,6)),a.faces.push(new c.u(6,2,1)),a.computeFaceNormals(),a.computeVertexNormals();var s=(new c.i).fromGeometry(a),l=new c.U(s,new c.V({color:16711680,transparent:!0,opacity:.1,side:c.r}));l.userData=e,l.name="MuonChamber";var h=new c.s(s),u=new c.J(h,new c.H({color:16777215,transparent:!0,opacity:.7})),p=new c.z;return p.add(l),p.add(u),e.uuid=l.uuid,p},e}()),J=n(18),H=n.n(J),z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),U=(function(e){function t(){var t=e.call(this)||this;return t.geometryScale=1e3,t.data={},t}z(t,e),t.prototype.loadObjectTypes=function(t){e.prototype.loadObjectTypes.call(this,t),t.MuonChambers&&this.addObjectType(t.MuonChambers,F.getMuonChamber,"MuonChambers")},t.prototype.readIgArchive=function(e,t,n){var r=new H.a,o=[];fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){r.loadAsync(e).then((function(){var e=Object.keys(r.files);n&&(e=e.filter((function(e){return e.includes(n)})));for(var i=1,a=function(n){n.toLowerCase().startsWith("events")?r.file(n).async("string").then((function(r){r=r.replace(/'/g,'"').replace(/\(/g,"[").replace(/\)/g,"]").replace(/nan/g,"0");var a=JSON.parse(r);a.eventPath=n,o.push(a),i===e.length&&t(o),i++})):(i===e.length&&t(o),i++)},s=0,c=e;s<c.length;s++){a(c[s])}}))}))},t.prototype.loadEventDataFromIg=function(e,t,n){this.readIgArchive(e,(function(e){n(e[0])}),t)},t.prototype.getEventData=function(){var e=this.data.Collections.Event_V2[0],t={runNumber:e[0],eventNumber:e[1],ls:e[2],time:e[5],Hits:{},Tracks:{},Jets:{},CaloClusters:{},MuonChambers:{}};t.Hits=this.getTrackingClusters(t.Hits),t.Tracks=this.getTracks(),t.Jets=this.getJets(),t.CaloClusters=this.getCaloClusters(),t.MuonChambers=this.getMuonChambers();for(var n=0,r=["Hits","Tracks","Jets","CaloClusters","MuonChambers"];n<r.length;n++){var o=r[n];0===Object.keys(t[o]).length&&(t[o]=void 0)}return t},t.prototype.getAllEventsData=function(e){for(var t={},n=0,r=e;n<r.length;n++){var o=r[n];this.data=o,t[o.eventPath]=this.getEventData()}return t},t.prototype.getTrackingClusters=function(e){var t=this,n=this.getObjectCollections(["TrackingRecHits_V1","SiStripClusters_V1","SiPixelClusters_V1","CSCLCTDigis_V1"],(function(e){e.pos&&(e.pos=e.pos.map((function(e){return e*t.geometryScale})))}));return Object.assign(e,n),e},t.prototype.getCaloClusters=function(){var e=this;return this.getObjectCollections(["SuperClusters_V1"],(function(t){t.energy&&(t.energy*=e.geometryScale)}))},t.prototype.getJets=function(){var e=this,t=Object.keys(this.data.Collections).filter((function(e){return e.toLowerCase().includes("jets")}));return this.getObjectCollections(t,(function(t){for(var n=0,r=["et","energy"];n<r.length;n++){var o=r[n];if(t[o]){t[o]*=e.geometryScale;break}}}),[{attribute:"et",min:10},{attribute:"energy",min:10}])},t.prototype.getMuonChambers=function(){var e=this;return this.getObjectCollections(["MatchingCSCs_V1","MuonChambers_V1"],(function(t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];(o.startsWith("front")||o.startsWith("back"))&&(t[o]=t[o].map((function(t){return t*e.geometryScale})))}}))},t.prototype.getObjectCollections=function(e,t,n){for(var r=this,o={},i=0,a=e=e.filter((function(e){return r.data.Collections[e]}));i<a.length;i++){var s=a[i];o[s]=[];for(var c=this.data.Types[s],l=function(e){var r={};if(c.forEach((function(t,n){r[t[0]]=e[n]})),n){for(var i=!0,a=!0,l=0,h=n;l<h.length;l++){var u=h[l];if(r[u.attribute]){if(u.max&&r[u.attribute]>u.max){i=!1;break}if(u.min&&r[u.attribute]<u.min){a=!1;break}}}i&&a&&(null===t||void 0===t||t(r),o[s].push(r))}else null===t||void 0===t||t(r),o[s].push(r)},h=0,u=this.data.Collections[s];h<u.length;h++){l(u[h])}0===o[s].length&&delete o[s]}return o},t.prototype.getTracks=function(){var e=this,t={},n=[{collection:"Tracks_V1",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"Tracks_V2",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"Tracks_V3",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"StandaloneMuons_V2",extras:"Extras_V1",assocs:"MuonTrackExtras_V1",color:"0xf57842",min_pt:1},{collection:"PATStandaloneMuons_V1",extras:"Extras_V1",assocs:"PATMuonTrackExtras_V1",color:"0xf5aa42",min_pt:1},{collection:"TrackerMuons_V2",extras:"Extras_V1",assocs:"MuonTrackerExtras_V1",color:"0xe8d546",min_pt:2},{collection:"GsfElectrons_V1",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1CFF1A",min_pt:10},{collection:"GsfElectrons_V2",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1bcf9f",min_pt:10},{collection:"GsfElectrons_V3",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1ad9ff",min_pt:10},{collection:"PATElectrons_V1",extras:"Extras_V1",assocs:"PATElectronExtras_V1",color:"0x1a40ff",min_pt:1}];n=n.filter((function(t){return e.data.Collections[t.collection]}));for(var r=function(e){t[e.collection]=[];for(var n,r=o.data.Collections[e.collection],i=o.data.Collections[e.extras],a=o.data.Associations[e.assocs],s=o.data.Types[e.collection],l=void 0,h=void 0,u=void 0,p=void 0,g=void 0,d=void 0,m=void 0,f=void 0,v=function(v){if(n={},s.forEach((function(e,t){n[e[0]]=r[v][t]})),n.pt<e.min_pt)return"continue";n.color=e.color,a[v][0][1],l=a[v][1][1],h=new c.Rb(i[l][0][0],i[l][0][1],i[l][0][2]),(u=new c.Rb(i[l][1][0],i[l][1][1],i[l][1][2])).normalize(),p=new c.Rb(i[l][2][0],i[l][2][1],i[l][2][2]),(g=new c.Rb(i[l][3][0],i[l][3][1],i[l][3][2])).normalize(),d=h.distanceTo(p),m=.25*d,f=new c.Rb(h.x+m*u.x,h.y+m*u.y,h.z+m*u.z),new c.Rb(p.x+m*g.x,p.y+m*g.y,p.z+m*g.z);for(var y=[],b=0,C=new c.sb(h,f,p).getPoints(24);b<C.length;b++){var M=C[b];M.multiplyScalar(o.geometryScale),y.push([M.x,M.y,M.z])}n.pos=y,t[e.collection].push(n)},y=0;y<a.length;y++)v(y);0===t[e.collection].length&&delete t[e.collection]},o=this,i=0,a=n;i<a.length;i++){r(a[i])}return t},t.prototype.getEventMetadata=function(){var t=e.prototype.getEventMetadata.call(this),n=this.data.Collections.Event_V2[0];return n[3]&&t.push({label:"Orbit",value:n[3]}),t}}(B),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),W=(function(e){function t(){var t=e.call(this)||this;return t.data={},t}U(t,e),t.prototype.process=function(e){console.log("Processing JiveXML event data"),this.data=e},t.prototype.getEventData=function(){var e=(new DOMParser).parseFromString(this.data,"text/xml").getElementsByTagName("Event")[0],t={eventNumber:e.getAttribute("eventNumber"),runNumber:e.getAttribute("runNumber"),lumiBlock:e.getAttribute("lumiBlock"),time:e.getAttribute("dateTime"),Hits:void 0,Tracks:{},Jets:{},CaloClusters:{}};return this.getTracks(e,t),this.getPixelClusters(e,t),this.getSCTClusters(e,t),this.getJets(e,t),this.getCaloClusters(e,t),t},t.prototype.getTracks=function(e,t){for(var n=e.getElementsByTagName("Track"),r=0,o=Array.from(n);r<o.length;r++){var i=o[r],a=Number(i.getAttribute("count")),s=[];if(0!==i.getElementsByTagName("numPolyline").length){var c=i.getElementsByTagName("numPolyline")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),l=i.getElementsByTagName("chi2")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),h=i.getElementsByTagName("numDoF")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),u=i.getElementsByTagName("polylineX");if(0!==u.length){for(var p=u[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),g=i.getElementsByTagName("polylineY")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),d=i.getElementsByTagName("polylineZ")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),m=i.getElementsByTagName("pt")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),f=i.getElementsByTagName("d0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),v=i.getElementsByTagName("z0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),y=i.getElementsByTagName("phi0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),b=i.getElementsByTagName("cotTheta")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),C=(i.getElementsByTagName("trackAuthor")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),0),M=0;M<a;M++){var T={chi2:0,dof:0,pos:[],dparams:[]};T.chi2=l[M],T.dof=h[M],T.dparams=[f[M],v[M],y[M],Math.tan(b[M]),1/m[M]];for(var E=[],w=0;w<c[M];w++)E.push([p[C+w],g[C+w],d[C+w]]);C+=c[M],T.pos=E,s.push(T)}var O=i.getAttribute("storeGateKey");"Tracks"===O&&(O="Tracks."),t.Tracks[O]=s}}else console.log("WARNING the track collection "+i.getAttribute("storeGateKey")+" has no line information. Skipping.")}},t.prototype.getPixelClusters=function(e,t){if(t.Hits={},0!==e.getElementsByTagName("PixCluster").length){var n=e.getElementsByTagName("PixCluster")[0],r=Number(n.getAttribute("count")),o=n.getElementsByTagName("x0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),i=n.getElementsByTagName("y0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),a=n.getElementsByTagName("z0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number);t.Hits.Pixel=[];for(var s=[],c=0;c<r;c++)s.push([10*o[c],10*i[c],10*a[c]]);t.Hits.Pixel.push(s)}},t.prototype.getSCTClusters=function(e,t){if(0!==e.getElementsByTagName("STC").length){var n=e.getElementsByTagName("STC")[0],r=Number(n.getAttribute("count")),o=n.getElementsByTagName("x0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),i=n.getElementsByTagName("y0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),a=n.getElementsByTagName("z0")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number);t.Hits.SCT=[];for(var s=[],c=0;c<r;c++)s.push([10*o[c],10*i[c],10*a[c]]);t.Hits.SCT.push(s)}},t.prototype.getTRT_DriftCircles=function(e,t){e.getElementsByTagName("TRT").length},t.prototype.getJets=function(e,t){for(var n=e.getElementsByTagName("Jet"),r=0,o=Array.from(n);r<o.length;r++){for(var i=o[r],a=Number(i.getAttribute("count")),s=i.getElementsByTagName("phi")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),c=i.getElementsByTagName("eta")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),l=i.getElementsByTagName("et")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),h=[],u=0;u<a;u++)h.push({coneR:.4,phi:s[u],eta:c[u],energy:1e3*l[u]});t.Jets[i.getAttribute("storeGateKey")]=h}},t.prototype.getCaloClusters=function(e,t){for(var n=e.getElementsByTagName("Cluster"),r=0,o=Array.from(n);r<o.length;r++){for(var i=o[r],a=Number(i.getAttribute("count")),s=i.getElementsByTagName("phi")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),c=i.getElementsByTagName("eta")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),l=i.getElementsByTagName("et")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),h=[],u=0;u<a;u++)h.push({phi:s[u],eta:c[u],energy:1e3*l[u]});t.CaloClusters[i.getAttribute("storeGateKey")]=h}}}(B),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),q=(function(e){function t(t,n){var r=e.call(this)||this;return r.JSROOT=t,r.rootFileURL=n,r.fileEventData={Hits:{},Tracks:{},Jets:{},CaloClusters:{}},r}W(t,e),t.prototype.getEventData=function(e,t){var n=this;this.JSROOT.OpenFile(this.rootFileURL,(function(r){for(var o=0,i=0,a=e;i<a.length;i++){var s=a[i];r.ReadObject(s,(function(r){if(o++,r&&n.processItemsList(r),o===e.length){for(var i=0,a=["Hits","Tracks","Jets","CaloClusters"];i<a.length;i++){var s=a[i];0===Object.keys(n.fileEventData[s]).length&&(n.fileEventData[s]=void 0)}t(n.fileEventData)}}))}}))},t.prototype.processItemsList=function(e){if("TObjArray"===e._typename||"TList"===e._typename){if(!e.arr)return;for(var t=0;t<e.arr.length;++t){var n=e.arr[t];this.processItemsList(n)}}else if("THREE.Mesh"===e._typename);else if("TGeoTrack"===e._typename){this.fileEventData.Tracks.TGeoTracks||(this.fileEventData.Tracks.TGeoTracks=[]);var r=this.getTGeoTrack(e);r&&this.fileEventData.Tracks.TGeoTracks.push(r)}else if("TEveTrack"===e._typename||"ROOT::Experimental::TEveTrack"===e._typename){this.fileEventData.Tracks[e._typename+"(s)"]||(this.fileEventData.Tracks[e._typename+"(s)"]=[]);var o=this.getTEveTrack(e);o&&this.fileEventData.Tracks[e._typename+"(s)"].push(o)}else if("TEvePointSet"===e._typename||"ROOT::Experimental::TEvePointSet"===e._typename||"TPolyMarker3D"===e._typename){this.fileEventData.Hits[e._typename+"(s)"]||(this.fileEventData.Hits[e._typename+"(s)"]=[]);var i=this.getHit(e);i&&this.fileEventData.Hits[e._typename+"(s)"].push(i)}else"TEveGeoShapeExtract"===e._typename||e._typename},t.prototype.getTGeoTrack=function(e){if(!e||!e.fNpoints)return!1;for(var t=Math.round(e.fNpoints/4),n=[],r=0;r<t-1;++r)n.push([e.fPoints[4*r],e.fPoints[4*r+1],e.fPoints[4*r+2]]);return{pos:n}},t.prototype.getTEveTrack=function(e){if(!e||e.fN<=0)return!1;for(var t={},n=[],r=0;r<e.fN-1;r++)n.push([e.fP[3*r],e.fP[3*r+1],e.fP[3*r+2]]);for(var o=0,i=e.fTitle.split("\n");o<i.length;o++)for(var a=0,s=i[o].split(/(?!\(.*), (?!.*\))/g);a<s.length;a++){var c=s[a].split("=");t[c[0]]=c[1]}return t.pos=n,t},t.prototype.getHit=function(e){if(!e||!e.fN||e.fN<0)return!1;for(var t=[],n=0;n<e.fN;n+=3)t.push([e.fP[3*n],e.fP[3*n+1],e.fP[3*n+2]]);return t}}(B),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),K=(function(e){function t(){var t=e.call(this)||this;return t.data={},t}q(t,e),t.prototype.process=function(e){console.log("Processing event data"),this.data=e},t.prototype.getEventData=function(){var e={eventNumber:this.data.eventNumber,runNumber:this.data.runNumber,Hits:{},Tracks:{}},t=[],n=this.data.PARTICLES;if(n)for(var r=0;r<n.length;r++){var o=n[r],i=Math.pow(o.px,2)+Math.pow(o.py,2)+Math.pow(o.pz,2),a={particle_id:o.name,pos:o.track,mom:i};t.push(a)}return e.Tracks={Particles:t},e},t.prototype.getEventMetadata=function(){var t=e.prototype.getEventMetadata.call(this);return this.data.time&&t.push({label:"Data recorded",value:this.data.time}),t}}(B),function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}),X=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},Z=(function(){function e(){}e.loadJSRootScripts=function(t){K(this,void 0,void 0,(function(){var n,r,o;return X(this,(function(i){switch(i.label){case 0:n=0,r=["JSRootCore.js","three.min.js","three.extra.min.js","ThreeCSG.js","d3.min.js","JSRootPainter.js","JSRoot3DPainter.js","JSRootGeoBase.js","JSRootGeoPainter.js"],i.label=1;case 1:return n<r.length?(o=r[n],[4,e.loadScript("assets/jsroot/"+o,"JSROOT")]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return t(JSROOT),[2]}}))}))},e.loadScript=function(e,t,n){return void 0===n&&(n=document.getElementsByTagName("head")[0]),new Promise((function(r,o){var i=document.querySelectorAll('script[src="'+e+'"]');if(0===i.length){var a=document.createElement("script");a.type="text/javascript",a.src=e,t&&a.setAttribute("data-scriptfor",t),a.addEventListener("load",(function(){a.setAttribute("data-loaded","true"),r()})),a.onerror=function(e){console.error("ERROR LOADING SCRIPT: ",e),o()},n.appendChild(a)}else"true"===i[0].dataset.loaded?r():i[0].addEventListener("load",(function(){r()}))}))}}(),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}());(function(e){function t(){var t=e.call(this)||this;return t.hitData=[],t.particleData=[],t.truthData={},t}Z(t,e),t.prototype.processHits=function(e){var t,n=e.split("\n");console.log("Event has this many hits:",n.length);for(var r=1;r<n.length;r++)t=n[r].split(","),this.hitData[t[0]]=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])]},t.prototype.processParticles=function(e){var t,n=e.split("\n");console.log("Event has this many particles:",n.length);for(var r=1;r<n.length;r++)t=n[r].split(","),this.particleData.push({particle_id:parseInt(t[0]),vertex_pos:[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])],mom:[parseFloat(t[4]),parseFloat(t[5]),parseFloat(t[6])]})},t.prototype.processTruth=function(e){var t,n=e.split("\n");console.log("Event has this many truth: ",n.length);for(var r=1;r<n.length;r++)t=n[r].split(","),this.truthData[t[0]]=[t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},t.prototype.getEventData=function(e){var t={eventNumber:e,runNumber:0,Hits:void 0,Tracks:void 0};if(this.hitData){t.Hits={},t.Hits.Reconstructed=[];var n=Math.round(this.hitData.length/5e3);n<1&&(n=1);for(var r=0,o=1;o<this.hitData.length;o++)o%n||(t.Hits.Reconstructed[r++]=[[this.hitData[o][0],this.hitData[o][1],this.hitData[o][2]]])}if(console.log("Will show this many hits",t.Hits.Reconstructed.length),this.truthData){if(t.Tracks={Particles:[]},this.particleData)for(o=0;o<this.particleData.length;o++)t.Tracks.Particles[o]={particle_id:this.particleData[o].particle_id,pos:[this.particleData[o].vertex_pos],mom:this.particleData[o].mom};var i=void 0,a=parseInt(String(this.truthData.length/10));for(o=1;o<this.truthData.length;o++){o,i=parseInt(this.truthData[o][0]);for(var s=0;s<t.Tracks.Particles.length;s++)t.Tracks.Particles[s].particle_id===i&&t.Tracks.Particles[s].pos.push([parseFloat(this.truthData[o][1]),parseFloat(this.truthData[o][2]),parseFloat(this.truthData[o][3])]);o%a===0&&(document.getElementById("info").innerHTML="Processed "+100*o/this.truthData.length+"% of event data.")}}for(s=0;s<t.Tracks.Particles.length;s++)t.Tracks.Particles[s].pos.length<3&&0;return t}})(B),n(32);var Y=function(){var e=new R;Object(r.useEffect)((function(){!function(){var t=new I("eventDisplay",!0);e.init(t),fetch("./phoenix-data/ATLAS/event-data.json").then((function(e){return e.json()})).then((function(t){e.parsePhoenixEvents(t)})),e.loadOBJGeometry("./phoenix-data/ATLAS/geometries/toroids.obj","Toroids",9211020,!1,!1),e.loadOBJGeometry("./phoenix-data/ATLAS/geometries/TRT.obj","TRT",3500709,!1),e.loadOBJGeometry("./phoenix-data/ATLAS/geometries/SCT.obj","SCT",16774144,!1),e.loadOBJGeometry("./phoenix-data/ATLAS/geometries/pixel.obj","Pixel",3500709,!1),e.loadOBJGeometry("./phoenix-data/ATLAS/geometries/LAR_Bar.obj","LAr Barrel",1690834,!0,!1),e.loadOBJGeometry("./phoenix-data/ATLAS/geometries/LAR_EC1.obj","LAr EC1",1690834,!0,!1),e.loadOBJGeometry("./phoenix-data/ATLAS/geometries/LAR_EC2.obj","LAr EC2",1690834,!0,!1),e.loadOBJGeometry("./phoenix-data/ATLAS/geometries/TileCal.obj","Tile Cal",12665667,!0,!1)}()}));var t=!1;return o.a.createElement("div",{id:"eventDisplay"},o.a.createElement("button",{id:"clipGeometries",onClick:function(){var n=e.getUIManager();t=!t,n.setClipping(t),t?n.rotateClipping(180):n.rotateClipping(0)}},"Clip Geometries"))};a.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Y,null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.dce6f28d.chunk.js.map